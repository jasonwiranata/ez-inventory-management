import flask
import sys
from flask import json
sys.path[0] = "\\sites-packages"
from google.cloud import bigquery
from flask import request, jsonify
client = bigquery.Client()

app = flask.Flask(__name__)
app.config["DEBUG"] = True

@app.route('/',methods=['GET'])
def homepage():
    return "Hello Welcome to EZ Inventory Management"


@app.route('/api/v1/resources/inventory',methods=['GET'])
def api_all():
    
    show_query = """
            SELECT number, production_id, production_date, material_description, quantity_used, unit, goods_description, quantity_produced, unit2
            from `smart-arc-313102.Inventory.production`
            """

    run_query = client.query(show_query)

    result = [dict(rows) for rows in run_query]

    json_ify = json.dumps(str(result))

    return json_ify

app.run()

// reference : https://programminghistorian.org/en/lessons/creating-apis-with-python-and-flask
